---
title: Node.js的ORM框架Sequelize
date: 2020-07-29
tags:
 - Node.js
 - Express
 - Sequelize
categories:
 - 后端
---
![img](https://i.loli.net/2020/08/04/fb8IEkSJ3QMLZ1Y.jpg)
<!-- more -->
### 安装sequelize

```bash
npm install --save sequelize
```

### 安装数据库驱动

```bash
# One of the following:
$ npm install --save pg pg-hstore # Postgres
$ npm install --save mysql2
$ npm install --save mariadb
$ npm install --save sqlite3
$ npm install --save tedious # Microsoft SQL Server
```

### 引入sequelize模块

```jsx
var Sequelize = require('sequelize');
```

### 连接数据库

```jsx
var sequelize = new Sequelize(
    'sample', // 数据库名
    'root',   // 用户名
    'psw',   // 用户密码
    {
        'dialect': 'mysql',  // 数据库使用mysql
        'host': 'localhost', // 数据库服务器ip
        'port': 3306,        // 数据库服务器端口
        'define': {
            // 字段以下划线（_）来分割（默认是驼峰命名风格）
            'underscored': true
        }
    }
);
```

### 定义表

```jsx
var User = sequelize.define(
  "user",

  {
    userId: {
      field: "user_id", //自定义列名
      primaryKey: true, //主键
      type: Sequelize.BIGINT, //类型
      allowNull: false, //是否为空
    },
    userName: {
      field: "user_name",
      type: Sequelize.STRING,
      allowNull: false,
    },
    userIcon: {
      field: "user_icon",
      type: Sequelize.STRING,
      allowNull: true,
    },
    title: {
      field: "title",
      type: Sequelize.STRING,
      allowNull: true,
    },
    gender: {
      field: "gender",
      type: Sequelize.ENUM("MALE", "FEMALE"),
      allowNull: true,
    },
    birth: {
      field: "birth",
      type: Sequelize.STRING,
      allowNull: true,
    },
    mail: {
      field: "mail",
      type: Sequelize.STRING,
      allowNull: true,
    },
    tel: {
      field: "tel",
      type: Sequelize.STRING,
      allowNull: true,
    },
    mobile: {
      field: "mobile",
      type: Sequelize.STRING,
      allowNull: true,
    },
    updateTime: {
      field: "update_time",
      type: Sequelize.STRING,
      allowNull: true,
    },
  },
  {
    tableName: "user", //表名
    timestamps: false, //时间戳更新
    freezeTableName: true, //冻结表名自动负复数化
  }
);
```

### 往表里添加数据

```jsx
User.create({
    userId: 23,
    userName: '老杨',
    updateTime: '2016-01-22 18:37:22'
});

```

### 修改表内数据

```jsx
var pram = { userName: "晓博" };

user.update(pram, {
  where: { userId: { eq: 23 } },
}); //将userId等于23的userName改为'晓博'

```

### 删除表内数据

```jsx
user.destroy({'where':{'id':{eq:23}}});//将表内userId等于23的元组删除
```