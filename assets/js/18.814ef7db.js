(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{499:function(s,a,t){"use strict";t.r(a);var e=t(4),n=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[t("img",{attrs:{src:"https://i.loli.net/2020/08/03/sZLxCgopYiE9Qcy.jpg",alt:"How to create a new project in Django | Hacker Noon"}})]),s._v(" "),t("h1",{attrs:{id:"django入门笔记3-数据库连接与datebase-api"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#django入门笔记3-数据库连接与datebase-api"}},[s._v("#")]),s._v(" Django入门笔记3-数据库连接与DateBase API")]),s._v(" "),t("h2",{attrs:{id:"数据库连接"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#数据库连接"}},[s._v("#")]),s._v(" 数据库连接")]),s._v(" "),t("p",[t("strong",[s._v("MySQL")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("DATABASES "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'default'")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ENGINE'")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'django.db.backends.mysql'")]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'NAME'")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'mydatabase'")]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'USER'")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'mydatabaseuser'")]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'PASSWORD'")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'mypassword'")]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'HOST'")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'127.0.0.1'")]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'PORT'")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3306'")]),s._v(",\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("p",[t("strong",[s._v("PostgreSQL")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("DATABASES "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'default'")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ENGINE'")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'django.db.backends.postgresql'")]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'NAME'")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'mydatabase'")]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'USER'")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'mydatabaseuser'")]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'PASSWORD'")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'mypassword'")]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'HOST'")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'127.0.0.1'")]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'PORT'")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'5432'")]),s._v(",\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("p",[t("strong",[s._v("MongoDB")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("DATABASES "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'default'")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ENGINE'")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" None, "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 把默认的数据库连接至为None")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\nfrom mongoengine "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("import")]),s._v(" connect\nconnect"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'test'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 连接的数据库名称")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[s._v("编写 "),t("code",[s._v("model.py")]),s._v(" 和 "),t("code",[s._v("[serializer.py](http://serializer.py)")]),s._v(" 创建模型和序列化")]),s._v(" "),t("p",[s._v("初始化模型及数据库")]),s._v(" "),t("p",[s._v("创建映射文件")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("python manage.py makemigrations\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("将映射文件中的映射到数据库中")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("python manage.py migrate\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"datebase-api"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#datebase-api"}},[s._v("#")]),s._v(" DateBase API")]),s._v(" "),t("p",[s._v("创建"),t("code",[s._v("model")])]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" django"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("db "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" models\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Blog")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("models"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Model"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  name "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" models"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("CharField"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("max_length"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  tagline "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" models"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("TextField"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("__str__")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("name\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Author")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("models"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Model"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  name "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" models"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("CharField"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("max_length"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("200")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  email "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" models"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("EmailField"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("__str__")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("name\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Entry")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("models"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Model"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  blog "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" models"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ForeignKey"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Blog"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" on_delete"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("models"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("CASCADE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  headline "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" models"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("charField"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("max_length"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("255")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  body_text "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" models"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("TextField"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  \n  pub_date "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" models"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("DateField"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  mod_date "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" models"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("DateField"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  authors "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" models"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ManyToManyField"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Author"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  n_comments "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" models"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("IntergerField"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  n_pingbacks "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" models"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("IntegerField"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  rating "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" models"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("IntegerField"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("__str__")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("headline\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("EntryDetail")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("models"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Model"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  entry "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" models"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("OneToOneField"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Entry"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" on_delete"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("models"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("CASCADE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  details "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" models"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("TextField"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1234567891011121314151617181920212223242526272829")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br")])]),t("h3",{attrs:{id:"创建对象"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建对象"}},[s._v("#")]),s._v(" "),t("strong",[s._v("创建对象")])]),s._v(" "),t("h3",{attrs:{id:"save"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#save"}},[s._v("#")]),s._v(" "),t("strong",[s._v("save")])]),s._v(" "),t("p",[s._v("需遵循如下步骤：")]),s._v(" "),t("ol",[t("li",[s._v("创建一个类的实例")]),s._v(" "),t("li",[s._v("在这个实例上调用"),t("code",[s._v("save()")])])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建实例")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("b1")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("Blog"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Beatles Blog"')]),s._v(", tagline "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"all the latest Beatles news."')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("b2")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("Blog"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Sue Blog"')]),s._v(", tagline "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"all latest news about Sue."')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("b3")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("Blog"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Computer Science"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("tagline")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Hello World!"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 保存对象")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" b1.save"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" b2.save"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" b3.save"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("p",[s._v("这在幕后执行了 INSERT SQL 语句。Django 在你显式调用 save() 才操作数据库。")]),s._v(" "),t("h3",{attrs:{id:"复制已有对象"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#复制已有对象"}},[s._v("#")]),s._v(" "),t("strong",[s._v("复制已有对象")])]),s._v(" "),t("p",[s._v("将想复制的对象的"),t("code",[s._v("pk")]),s._v("设为"),t("code",[s._v("None")]),s._v("，然后"),t("code",[s._v("save()")]),s._v("即可。")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v(">>> b = Blog.objects.all().get(pk=4)\n>>> b.pk = None\n>>> b.save()\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("需要注意的是， 这种方法并不会复制对象的"),t("code",[s._v("ManyToManyField")]),s._v("等属性，因此针对"),t("code",[s._v("ManyToMany")]),s._v("的情况，我们可以：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("entry = Entry.objects.all()[0]\n>>> old_authors = entry.authors.all()\n>>> entry.pk = None\n>>> entry.save()\n>>> entry.authors.set(old_authors)12345\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("而"),t("code",[s._v("OneToOne")]),s._v("的情况，我们可以：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('>>> EntryDetail.objects.create(entry=Entry.objects.all()[0], details="None")\n<EntryDetail: EntryDetail object (1)>\n>>> detail = EntryDetail.objects.all()[0]\n>>> detail.pk=None\n>>> detail.entry=Entry.objects.all()[1]\n>>> detail.save()123456\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("hr"),s._v(" "),t("h3",{attrs:{id:"查询对象"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查询对象"}},[s._v("#")]),s._v(" "),t("strong",[s._v("查询对象")])]),s._v(" "),t("p",[s._v("在Django中，每一个"),t("code",[s._v("model")]),s._v("都至少有一个Manager，默认有一个Manager叫"),t("code",[s._v("objects")]),s._v("（即"),t("code",[s._v("objects")]),s._v("是"),t("code",[s._v("django.db.models.manager.Manager")]),s._v("的实例），我们通过调用这个变量的方法可以获得一个包含对象集合的"),t("code",[s._v("QuerySet")])]),s._v(" "),t("h3",{attrs:{id:"获得所有对象"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#获得所有对象"}},[s._v("#")]),s._v(" "),t("strong",[s._v("获得所有对象")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v(">>> Blog.objects.all()\n<QuerySet [<Blog: Beatles Blog>, <Blog: Sue Blog>, <Blog: Computer Science>]>12\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"获得满足过滤条件的部分对象"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#获得满足过滤条件的部分对象"}},[s._v("#")]),s._v(" "),t("strong",[s._v("获得满足过滤条件的部分对象")])]),s._v(" "),t("ol",[t("li",[t("code",[s._v("filter")]),s._v(" 返回满足条件的对象集合")]),s._v(" "),t("li",[t("code",[s._v("exclude")]),s._v(" 在所有对象的集合中排除满足条件的对象集合并返回")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('>>> Blog.objects.filter(name="Computer Science")\n<QuerySet [<Blog: Computer Science>]>\n>>> Blog.objects.exclude(pk=1)\n<QuerySet [<Blog: Sue Blog>, <Blog: Compter Science>]>\n>>> Blog.objects.exclude(pk=3).filter(name__startswith="Beatles")\n<QuerySet [<Blog: Beatles Blog>]>123456\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("上述例子中可以看出：1. 由于"),t("code",[s._v("filter()")]),s._v(" "),t("code",[s._v("exclude()")]),s._v("均返回"),t("code",[s._v("QuerySet()")]),s._v("，因此可以链式调用2. 参数形式为"),t("code",[s._v("field__lookuptype=filter_value")]),s._v("，类似SQL语句中"),t("code",[s._v("WHERE")]),s._v("后面的写法。3. 关于"),t("code",[s._v('name__startswith="Beatles"')]),s._v("，后面会有讲解。")]),s._v(" "),t("p",[s._v("另外有一点需要注意，创建一个QuerySet不涉及任何数据库操作，只有在使用它的时候，才会去访问数据库。")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('>>> q = Blog.objects.filter(name="Computer Science")\n>>> q = q.exclude(pk=1)\n>>> print(q)\n<QuerySet []>1234\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("前面两句都是在创建一个QuerySet，只有最后一句才使用了它，因此整段代码只有在最后一句才真正访问了数据库。")]),s._v(" "),t("h3",{attrs:{id:"获得某一个对象"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#获得某一个对象"}},[s._v("#")]),s._v(" "),t("strong",[s._v("获得某一个对象")])]),s._v(" "),t("p",[s._v("如果能够确定某种过滤条件能而且只能返回一个对象，我们可以使用"),t("code",[s._v("get()")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v(">>> Blog.objects.get(pk=1)\n<Blog: Beatles Blog>\n>>> Blog.objects.filter(pk=1)[0]\n<Blog: Beatles Blog>1234\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("上述例子中，我们似乎可以看出"),t("code",[s._v("get()")]),s._v("与"),t("code",[s._v("filter()")]),s._v("+"),t("code",[s._v("[0]")]),s._v("可以做同一件事情，事实不是这样的，我们再举一个例子：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('>>> Blog.objects.get(pk=4)\n...\nblog.models.DoesNotExist: Blog matching query does not exist.\n>>> Blog.objects.get(name__endswith="Blog")\n...\nblog.models.MultipleObjectsReturned: get() returned more than one Blog -- it returned 2!\n>>> Blog.objects.filter(pk=4)\n<QuerySet []>\n>>> Blog.objects.filter(pk=4)[0]\n...\nIndexError: list index out of range1234567891011\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("p",[s._v("可以看出"),t("code",[s._v("get()")]),s._v("更加严格，无论是找不到对象，可以返回的对象不止一个，均会报错（"),t("code",[s._v("DoesNotExist")]),s._v(" "),t("code",[s._v("MultipleObjectsReturned")]),s._v("）")]),s._v(" "),t("h3",{attrs:{id:"限制返回的对象数量"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#限制返回的对象数量"}},[s._v("#")]),s._v(" "),t("strong",[s._v("限制返回的对象数量")])]),s._v(" "),t("ol",[t("li",[s._v("返回前2个对象")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v(">>> Blog.objects.all()[:2]\n<QuerySet [<Blog: Beatles Blog>, <Blog: Sue Blog>]>12\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("ol",[t("li",[s._v("返回第2个到第3个对象")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v(">>> Blog.objects.all()[1:3]\n<QuerySet [<Blog: Sue Blog>, <Blog: Compter Science>]>12\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("ol",[t("li",[s._v("返回第三个对象")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v(">>> Blog.objects.all()[2]\n<Blog: Compter Science>12\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("hr"),s._v(" "),t("h3",{attrs:{id:"更多查找条件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#更多查找条件"}},[s._v("#")]),s._v(" "),t("strong",[s._v("更多查找条件")])]),s._v(" "),t("p",[s._v("我们在写一个SQL语句时，WHERE部分不仅仅局限于"),t("code",[s._v("=")]),s._v("，比如：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("WHERE pub_date <= '2018-02-19'WHERE 12\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("那么如何在Django中表示更多的查找条件呢？我们使用上文提到过的如下形式：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("field__lookuptype=filter_value1\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"lte"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#lte"}},[s._v("#")]),s._v(" "),t("strong",[s._v("lte")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v(">>> Entry.objects.filter(pub_date__lte='2006-01-01')\n<QuerySet []>12\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"exact"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#exact"}},[s._v("#")]),s._v(" "),t("strong",[s._v("exact")])]),s._v(" "),t("p",[s._v("即相等")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('>>> Entry.objects.filter(body_text__exact="None")\n<QuerySet [<Entry: Beatles\' first song>]>12\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("相当于")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('>>> Entry.objects.filter(body_text="None")\n<QuerySet [<Entry: Beatles\' first song>]>12\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"iexact"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#iexact"}},[s._v("#")]),s._v(" "),t("strong",[s._v("iexact")])]),s._v(" "),t("p",[s._v("在忽略大小写的情况下，是否相等。")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('>>> Entry.objects.filter(body_text__iexact="none")\n<QuerySet [<Entry: Beatles\' first song>]>12\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"contains"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#contains"}},[s._v("#")]),s._v(" "),t("strong",[s._v("contains")])]),s._v(" "),t("p",[s._v("字符串中是否包含给定字符串，相当于SQL语句中的"),t("code",[s._v("LIKE")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('>>> Entry.objects.filter(body_text__contains="No")\n<QuerySet [<Entry: Beatles\' first song>]>12\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"icontains"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#icontains"}},[s._v("#")]),s._v(" "),t("strong",[s._v("icontains")])]),s._v(" "),t("p",[s._v("在忽略大小写的情况下，字符串中是否包含给定字符串。")]),s._v(" "),t("h3",{attrs:{id:"startswith"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#startswith"}},[s._v("#")]),s._v(" "),t("strong",[s._v("startswith")])]),s._v(" "),t("p",[s._v("字符串是否以给定字符串开头")]),s._v(" "),t("h3",{attrs:{id:"endswith"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#endswith"}},[s._v("#")]),s._v(" "),t("strong",[s._v("endswith")])]),s._v(" "),t("p",[s._v("字符串是否以给定字符串结尾")]),s._v(" "),t("h3",{attrs:{id:"istartswith"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#istartswith"}},[s._v("#")]),s._v(" "),t("strong",[s._v("istartswith")])]),s._v(" "),t("p",[s._v("在忽略大小写的情况下，字符串是否以给定字符串开头")]),s._v(" "),t("h3",{attrs:{id:"endswith-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#endswith-2"}},[s._v("#")]),s._v(" "),t("strong",[s._v("endswith")])]),s._v(" "),t("p",[s._v("在忽略大小写的情况下，字符串是否以给定字符串结尾")]),s._v(" "),t("h3",{attrs:{id:"对象的属性的属性"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#对象的属性的属性"}},[s._v("#")]),s._v(" "),t("strong",[s._v("对象的属性的属性")])]),s._v(" "),t("p",[s._v("当我们通过判断对象的属性的属性是否符合某个条件来查找对象时，不能使用"),t("code",[s._v(".")]),s._v("，应使用"),t("code",[s._v("__")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('>>> Entry.objects.filter(blog__name__contains="Sue")\n<QuerySet [<Entry: Beatles\' first song>]>12\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"对象的外键"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#对象的外键"}},[s._v("#")]),s._v(" "),t("strong",[s._v("对象的外键")])]),s._v(" "),t("p",[s._v("当我们通过对象的外键是否符合某个条件来查找对象时，有以下几种方式：1. 上文提到的一种方式")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('>>> Entry.objects.filter(blog__name__contains="Sue")\n<QuerySet [<Entry: Beatles\' first song>]>12\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("ol",[t("li",[s._v("如果可以获得外键实例，可直接判断是否相等")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v(">>> b = Blog.objects.all().get(pk=2)\n>>> Entry.objects.filter(blog=b)\n<QuerySet [<Entry: Beatles' first song>]>123\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("ol",[t("li",[s._v("如果知道外键的"),t("code",[s._v("id")]),s._v("：")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v(">>> Entry.objects.filter(blog_id=2)\n<QuerySet [<Entry: Beatles' first song>]>12\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("或者")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v(">>> Entry.objects.filter(blog=2)\n<QuerySet [<Entry: Beatles' first song>]>12\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("或者")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v(">>> Entry.objects.filter(blog=b.id)\n<QuerySet [<Entry: Beatles' first song>]>12\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("我们可以通过"),t("code",[s._v("foreignkeyname_id")]),s._v("的形式获得外键的"),t("code",[s._v("id")])]),s._v(" "),t("h3",{attrs:{id:"q对象"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#q对象"}},[s._v("#")]),s._v(" "),t("strong",[s._v("Q对象")])]),s._v(" "),t("p",[s._v("Q对象可以做更加复杂的匹配，可以封装多个过滤条件。1. 封装单个过滤条件")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('>>> Blog.objects.all().filter(Q(name__startswith="Beatles"))\n<QuerySet [<Blog: Beatles Blog>, <Blog: Beatles Blog>]>12\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("ol",[t("li",[s._v("与 或 非")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('Q(question__startswith="WHO") | ~Q(question__startswith="WHAT")1\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ol",[t("li",[s._v("多个过滤条件")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('Blog.objects.filter(Q(name__startswith("b")), Q(name__endswith("s")))1\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("当往Q输入多个参数时，它们之间的关系为"),t("code",[s._v("AND")])]),s._v(" "),t("hr"),s._v(" "),t("h3",{attrs:{id:"更新对象"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#更新对象"}},[s._v("#")]),s._v(" "),t("strong",[s._v("更新对象")])]),s._v(" "),t("h3",{attrs:{id:"更新单个对象"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#更新单个对象"}},[s._v("#")]),s._v(" "),t("strong",[s._v("更新单个对象")])]),s._v(" "),t("p",[t("strong",[s._v("更新普通字段")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('>>> b.name="Beatles\' Blog"\n>>> b.save()12\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"更新外键"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#更新外键"}},[s._v("#")]),s._v(" "),t("strong",[s._v("更新外键")])]),s._v(" "),t("p",[s._v("首先创建一个"),t("code",[s._v("Entry")]),s._v("对象：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('entry = Entry(blog=b, headline="Beatles\' first song",  body_text="None",pub_date=datetime.now(),n_comments=4,n_pingbacks=4,rating=4,mod_date=datetime.now())\n>>> entry.save()12\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("修改"),t("code",[s._v("entry")]),s._v("的外键：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("b = Blog.objects.all().get(pk=2)\n>>> entry.blog = b\n>>> entry.save()\n>>> Entry.objects.all()[0].blog\n<Blog: Sue Blog>12345\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h3",{attrs:{id:"更新多对多字段"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#更新多对多字段"}},[s._v("#")]),s._v(" "),t("strong",[s._v("更新多对多字段")])]),s._v(" "),t("p",[s._v("首先新建一个"),t("code",[s._v("Author")]),s._v("实例：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('>>> a1 = Author.objects.create(name="Sue", email="158@qq.com")\n>>> a2 = Author.objects.create(name="Bob", email="189@qq.com")12\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("使用"),t("code",[s._v("add()")]),s._v("为"),t("code",[s._v("authors")]),s._v("字段添加一个实例")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v(">>> entry.authors.add(a1, a2)\n>>> Entry.objects.all()[0].authors.get(id=1)\n<Author: Sue>123\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("需要注意的是：1. "),t("code",[s._v("add()")]),s._v("方法后，不需要"),t("code",[s._v("save()")]),s._v("2. 这里使用"),t("code",[s._v("create()")]),s._v("创建对象，它是"),t("code",[s._v("Manager")]),s._v("的一个方法。也不需要"),t("code",[s._v("save()")])]),s._v(" "),t("h3",{attrs:{id:"更新多个对象"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#更新多个对象"}},[s._v("#")]),s._v(" "),t("strong",[s._v("更新多个对象")])]),s._v(" "),t("p",[s._v("使用"),t("code",[s._v("update()")]),s._v("并配合"),t("code",[s._v("filter()")]),s._v(" "),t("code",[s._v("all()")]),s._v("等，对一个对象集合进行更新操作。"),t("code",[s._v("update()")]),s._v("返回需要更新的对象数（也许不是发生改变的对象数，因为有的对象已经有了最新值）")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('>>> Entry.objects.filter(pub_date__year=2018).update(headline="Everything is the same.")\n312\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("需要注意的是，使用这个方法只能更新外键或者没关系型字段")]),s._v(" "),t("hr"),s._v(" "),t("h3",{attrs:{id:"删除对象"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#删除对象"}},[s._v("#")]),s._v(" "),t("strong",[s._v("删除对象")])]),s._v(" "),t("p",[s._v("使用"),t("code",[s._v("delete()")]),s._v("来删除的对象，为了避免误删除，"),t("code",[s._v("Manager")]),s._v("本身并没有暴露"),t("code",[s._v("delete()")]),s._v("方法。"),t("code",[s._v("delete()")]),s._v("返回删除的对象数量以及按照对象类型的分类汇总。")]),s._v(" "),t("h3",{attrs:{id:"删除所有对象"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#删除所有对象"}},[s._v("#")]),s._v(" "),t("strong",[s._v("删除所有对象")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v(">>> Blog.objects.all().delete()\n(7, {'blog.Entry_authors': 3, 'blog.EntryDetail': 0, 'blog.Entry': 1, 'blog.Blog': 3})12\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("我们需要注意的是：1. 返回结果显示，此次删除操作删除了7个对象，3个Blog实例，1个Entry实例，3个"),t("code",[s._v("Entry_authors")]),s._v("中的对象。2. 默认情况下， "),t("code",[s._v("delete()")]),s._v("遵循级联删除的规则，即以被删除对象为外键的对象同时被删除。我们可以通过在定义"),t("code",[s._v("model")]),s._v("时添加"),t("code",[s._v("on_delete")]),s._v("参数来指定级联规则")]),s._v(" "),t("h3",{attrs:{id:"删除指定对象"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#删除指定对象"}},[s._v("#")]),s._v(" "),t("strong",[s._v("删除指定对象")])]),s._v(" "),t("p",[s._v("我们可以配合使用"),t("code",[s._v("get()")]),s._v(" "),t("code",[s._v("filter()")]),s._v("等获得指定对象或包含指定对象集的"),t("code",[s._v("QuerySet")]),s._v("，然后调用"),t("code",[s._v("delete()")])]),s._v(" "),t("h3",{attrs:{id:"sql"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#sql"}},[s._v("#")]),s._v(" "),t("strong",[s._v("SQL")])]),s._v(" "),t("p",[s._v("最后，我们也可以使用原生的SQL在访问数据库。")])])}),[],!1,null,null,null);a.default=n.exports}}]);